<!doctype html>
<html lang="ru" data-install-success="{{ 1 if install_success else 0 }}">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Argent UserBot ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∫–∞</title>
  <meta name="description" content="–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Argent UserBot: –≤–≤–µ–¥–∏ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏ –≤ Telegram" />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
</head>
<body class="argent">
  <header class="topbar">
    <div class="brand">‚öóÔ∏è Argent UserBot</div>
  </header>
  <main class="container">
    <section class="card">
      <h1>üß™ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî –≠—Ç–∞–ø I</h1>
      <p class="muted">üî¨ –í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤. –ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Å–∏–Ω—Ç–µ–∑–∞.</p>
      {% if error %}
      <div class="alert error show-once">{{ error }}</div>
      {% endif %}
      {% if not install_success %}
      <form method="post" action="/setup/bot-token" onsubmit="return onSubmit()" autocomplete="off">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
        <label for="bot_token">üîê –¢–æ–∫–µ–Ω Telegram –ë–æ—Ç–∞</label>
        <input 
          id="bot_token" 
          name="bot_token" 
          type="password" 
          placeholder="123456789:ABC-DEF1234ghIkl-zyx57W2v1u123ew11" 
          required 
          autocomplete="off"
          spellcheck="false"
          maxlength="100"
          pattern="[0-9]+:[A-Za-z0-9_-]+"
          title="–í–≤–µ–¥–∏—Ç–µ –≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: 123456789:ABC-DEF..."
        />
        <button type="submit" class="primary">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É</button>
      </form>
      {% endif %}
      {% if install_success %}
      <div id="install-success" class="install-success">
        <div class="success-checkmark">‚úì</div>
        <div class="success-text">Argent Userbot —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</div>
      </div>
      {% endif %}
      {% if not install_success %}
      <p class="hint">üîí –ö–≤–∞–Ω—Ç–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: —Ç–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.</p>
      {% endif %}
      
    </section>
  </main>
  <footer class="footer">¬© Argent UserBot</footer>
  <script>

    (function() {
      'use strict';

      if (typeof console !== 'undefined') {
        console.clear();
        console.log('%cüîê Argent UserBot Security', 'color: #6366f1; font-size: 16px; font-weight: bold;');
        console.log('%c–ù–µ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ —Å—é–¥–∞ –Ω–∏–∫–∞–∫–æ–π –∫–æ–¥! –≠—Ç–æ –º–æ–∂–µ—Ç —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.', 'color: #ef4444; font-size: 14px;');
      }
      
      function sanitizeInput(input) {
        return input.replace(/[<>\"'&]/g, '');
      }
      
      function validateTokenFormat(token) {
        const tokenRegex = /^[0-9]+:[A-Za-z0-9_-]+$/;
        return tokenRegex.test(token) && token.length >= 35 && token.length <= 100;
      }
      
      window.onSubmit = function() {
        const btn = document.querySelector('button.primary');
        const tokenInput = document.getElementById('bot_token');
        if (!tokenInput) return false;
        const token = tokenInput.value.trim();

        if (!validateTokenFormat(token)) {
          alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞.');
          return false;
        }

        tokenInput.value = sanitizeInput(token);

        btn.disabled = true;
        btn.classList.add('clicked');
        btn.textContent = '‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞...';

          setTimeout(() => {
          if (btn.disabled) {
            btn.disabled = false;
            btn.classList.remove('clicked');
            btn.textContent = 'üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É';
          }
        }, 5000);
        
        return true;
      };

      const tokenEl = document.getElementById('bot_token');
      if (tokenEl) tokenEl.addEventListener('input', function(e) {

        this.value = this.value.replace(/\s/g, '');
      });

      window.addEventListener('beforeunload', function() {
        const tokenInput = document.getElementById('bot_token');
        if (tokenInput) {
          tokenInput.value = '';
        }
      });

      document.addEventListener('DOMContentLoaded', function() {
        const installSuccess = document.documentElement.getAttribute('data-install-success') === '1';
        if (installSuccess) {
          const form = document.querySelector('form[action="/setup/bot-token"]');
          if (form) form.remove();
          const hint = document.querySelector('.hint');
          if (hint) hint.style.display = 'none';
        }
      });
      
    })();
  </script>
</body>
</html>
